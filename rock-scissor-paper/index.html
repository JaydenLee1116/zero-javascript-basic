<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rock-Scissor-Paper</title>
    <style>
      #computer {
        width: 142px;
        height: 200px;
      }
    </style>
  </head>
  <body>
    <div id="computer"></div>
    <div>
      <button id="scissors" class="btn">ê°€ìœ„</button>
      <button id="rock" class="btn">ë°”ìœ„</button>
      <button id="paper" class="btn">ë³´</button>
    </div>
    <div id="score">0</div>
    <script>
      const $computer = document.querySelector('#computer');
      const $score = document.querySelector('#score');
      const $rock = document.querySelector('#rock');
      const $scissors = document.querySelector('#scissors');
      const $paper = document.querySelector('#paper');
      const IMG_URL = './rsp.png';
      $computer.style.background = `url(${IMG_URL}) 0 0`;
      $computer.style.backgroundSize = 'auto 200px';

      const rspX = {
        scissors: '0',
        rock: '-220px',
        paper: '-440px',
      };

      let computerChoice = 'scissors';
      const changeComputerHand = () => {
        if (computerChoice === 'scissors') {
          computerChoice = 'rock';
        } else if (computerChoice === 'rock') {
          computerChoice = 'paper';
        } else if (computerChoice === 'paper') {
          computerChoice = 'scissors';
        }
        $computer.style.background = `url(${IMG_URL}) ${rspX[computerChoice]} 0`;
        $computer.style.backgroundSize = 'auto 200px';
      };

      let intervalId = setInterval(changeComputerHand, 50);

      // ðŸŒŸ 1. ì´ë²¤íŠ¸ë¥¼ ì œê±°í•˜ê³  ë‹¤ì‹œ ì¶”ê°€í•˜ëŠ” ë°©ì‹
      // const clickButton = () => {
      //   clearInterval(intervalId);
      //   $rock.removeEventListener('click', clickButton);
      //   $scissors.removeEventListener('click', clickButton);
      //   $paper.removeEventListener('click', clickButton);
      //   setTimeout(() => {
      //     intervalId = setInterval(changeComputerHand, 50);
      //     $rock.addEventListener('click', clickButton);
      //     $scissors.addEventListener('click', clickButton);
      //     $paper.addEventListener('click', clickButton); // ë‹¤ì‹œ ì‹œìž‘í•˜ëŠ” setIntervalì— ëŒ€í•´ì„  ë‹¤ì‹œ ë³€ìˆ˜ì— í• ë‹¹í•´ì£¼ì–´ì•¼í•©ë‹ˆë‹¤.
      //   }, 1000);
      // };

      // $rock.addEventListener('click', clickButton);
      // $scissors.addEventListener('click', clickButton);
      // $paper.addEventListener('click', clickButton);

      // ðŸŒŸ ê°€ìœ„ë°”ìœ„ë³´ ê²½ìš°ì˜ ìˆ˜ë¥¼ ì¢€ë” ê¹”ë”í•˜ê²Œ í•˜ê¸° ìœ„í•œ í…Œì´ë¸”
      const numberTable = {
        rock: 0,
        scissors: 1,
        paper: -1,
      };

      // ðŸŒŸ 2. clickableì´ë¼ëŠ” ë³€ìˆ˜ë¥¼ í†µí•´ ì œì–´í•˜ëŠ” ë°©ì‹
      let count = 0;
      let myScore = 0;
      let computerScore = 0;
      let clickable = true;
      const clickButton = () => {
        if (clickable) {
          clearInterval(intervalId);
          clickable = false;
          const myChoice =
            event.target.textContent === 'ë°”ìœ„'
              ? 'rock'
              : event.target.textContent === 'ê°€ìœ„'
              ? 'scissors'
              : 'paper';

          const myNumber = numberTable[myChoice];
          const computerNumber = numberTable[computerChoice];
          let diff = myNumber - computerNumber;
          let message;
          if (diff === 2 || diff === -1) {
            myScore++;
            count++;
            message = 'ìŠ¹ë¦¬';
          } else if (diff === -2 || diff === 1) {
            computerScore++;
            count++;
            message = 'íŒ¨ë°°';
          } else {
            message = 'ë¬´ìŠ¹ë¶€';
          }

          if (myScore >= 3) {
            alert('ì¶•í•˜ë“œë¦½ë‹ˆë‹¤! ìŠ¹ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.');
            myScore = 0;
            computerScore = 0;
            count = 0;
          } else if (computerScore >= 3) {
            alert('ì•ˆíƒ€ê¹ìŠµë‹ˆë‹¤! íŒ¨ë°°í•˜ì˜€ìŠµë‹ˆë‹¤.');
            myScore = 0;
            computerScore = 0;
            count = 0;
          } else if (count >= 5) {
            alert('ë¬´ìŠ¹ë¶€ìž…ë‹ˆë‹¤!');
            myScore = 0;
            computerScore = 0;
            count = 0;
          }

          $score.textContent = `ê²°ê³¼: ${message}ìž…ë‹ˆë‹¤. ðŸ¤© ë‚´ ì ìˆ˜: ${myScore} ì»´í“¨í„° ì ìˆ˜: ${computerScore}`;
          setTimeout(() => {
            clickable = true;
            intervalId = setInterval(changeComputerHand, 50);
          }, 1000);
        }
      };

      $rock.addEventListener('click', clickButton);
      $scissors.addEventListener('click', clickButton);
      $paper.addEventListener('click', clickButton);

      /*
      ðŸŒŸ ì•„ëž˜ì™€ ê°™ì´ setTimeoutì„ ì´ìš©í•´ì„œ ê°™ì€ ë™ìž‘ì„ í‘œí˜„í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
      ë‹¨, ì—„ë°€ížˆ ë”°ì§€ë©´ ë™ìž‘ì´ ì¡°ê¸ˆ ë‹¤ë¥´ê¸´ í•©ë‹ˆë‹¤.
      setIntervalì„ ì‚¬ìš©í•˜ëŠ” íŽ¸ì´ ì¢€ë” ì •í™•í•œ ì‹œê°„ì„ ë§žì¶”ê¸° ìœ„í•´ ì¢‹ìŠµë‹ˆë‹¤.

      const changeComputerHand = () => {
        if (computerChoice === 'scissors') {
          computerChoice = 'rock';
        } else if (computerChoice === 'rock') {
          computerChoice = 'paper';
        } else if (computerChoice === 'paper') {
          computerChoice = 'scissors';
        }
        $computer.style.background = `url(${IMG_URL}) ${rspX[computerChoice]} 0`;
        $computer.style.backgroundSize = 'auto 200px';
        setTimeout(changeComputerHand, 50)
      };
      setTimeout(changeComputerHand, 50);
      */
    </script>
  </body>
</html>
